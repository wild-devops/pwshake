pwshake-context:
  templates:
    script:
      powershell: |
        $paths = $config.scripts_directories | ForEach-Object { Join-Path $config.attributes.pwshake_path -ChildPath $_ }
        $script_path = Get-ChildItem $paths -File `
            | Where-Object BaseName -eq $step.script `
            | Select-Object -ExpandProperty FullName
        Log-Information "Script file: $script_path"
        if (-not $script_path) { throw "Script file: $($step.script).* not found." }
        & $script_path -attributes $config.attributes
